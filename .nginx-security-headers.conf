# Security Headers for Wordfeud Helper
# Include this file in your Nginx server block or location block
#
# Usage in nginx.conf or site config:
# server {
#     ...
#     include /path/to/.nginx-security-headers.conf;
#     ...
# }

# Content Security Policy - Prevents XSS attacks
add_header Content-Security-Policy "default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; worker-src 'self'; connect-src 'self'; img-src 'self' data:; font-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self'; frame-ancestors 'none'; upgrade-insecure-requests;" always;

# Prevent clickjacking attacks
add_header X-Frame-Options "DENY" always;

# Prevent MIME type sniffing
add_header X-Content-Type-Options "nosniff" always;

# Privacy: Don't send referrer to external sites
add_header Referrer-Policy "no-referrer" always;

# Force HTTPS (only enable if using HTTPS)
# Uncomment the line below if you have SSL/TLS enabled
# add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;

# Disable unnecessary browser features
add_header Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=()" always;

# XSS Protection (legacy header, but adds defense in depth)
add_header X-XSS-Protection "1; mode=block" always;

# Prevent caching of sensitive data (if needed)
# add_header Cache-Control "no-store, no-cache, must-revalidate, proxy-revalidate" always;
# add_header Pragma "no-cache" always;
# add_header Expires "0" always;
